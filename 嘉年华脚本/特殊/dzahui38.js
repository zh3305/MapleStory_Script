var status = 0;
var choice;
var itemxh=new Array("2020000","2020001","2020002","2020003","2020004","2020005","2020006","2020007","2020008","2020009","2020010","2020011","2020012","2020013","2020014","2020015","2020016","2020017","2020018","2020019","2020020","2020021","2020022","2020023","2020024","2020025","2020026","2020027","2020028","2020029","2020030","2020031","2020032","2020033","2020034","2020035","2022000","2022001","2022002","2022003","2022004","2022005","2022006","2022007","2022008","2022009","2022010","2022011","2022012","2022013","2022014","2022015","2022016","2022017","2022018","2022019","2022020","2022021","2022022","2022023","2022024","2022025","2022026","2022027","2022028","2022029","2022030","2022031","2022032","2022033","2022034","2022035","2022036","2022037","2022038","2022039","2022040","2022041","2022042","2022043","2022050","2022051","2022052","2022053","2022054","2022055","2022056","2022057","2022058","2022060","2022061","2022062","2022063","2022064","2022071","2022072","2022074","2022075","2022076","2022077","2022078","2022086","2022087","2022088","2022089","2022094","2022096","2022097","2022098","2022100","2022101","2022102","2022103","2022109","2022112","2022113","2022116","2022123","2022131","2022132","2022133","2022134","2022135","2022136","2022137","2022138","2022139","2022140","2022141","2022142","2022143","2022144","2022145","2022146","2022147","2022148","2022149","2022150","2022153","2022154","2022155","2022156","2022170","2022171","2022172","2022173","2022182","2022183","2022184","2022185","2022186","2022189","2022190","2022191","2022192","2022193","2022194","2022195","2022196","2022197","2022198","2022200","2022201","2022202","2022203","2022204","2022205","2022206","2022207","2022208","2022209","2022210","2022211","2022212","2022213","2022214","2022215","2022216","2022217","2022218","2022219","2022220","2022221","2022222","2022223","2022229","2022238","2022242","2022243","2022244","2022245","2022246","2022247","2022248","2022249","2022250","2022251","2022252","2022253","2022255","2022256","2022257","2022258","2022259","2022260","2022265","2022279","2022280","2022285","2022292","2022302","2022304","2022309","2022324","2022335","2022336","2022337","2022345","2022352");
var itemxhcost=new Array("0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0");

function start() {
    status = -1;
    action(1, 0, 0);
}

function action(mode, type, selection) {
    if (mode == -1) cm.dispose();
    else {
        if (status == 0 && mode == 0) {
            cm.dispose();
            return;
        } else if (status >= 1 && mode == 0) {
            cm.sendOk("好吧，欢迎下次继续光临！.");
            cm.dispose();
            return;
        }
        if (mode == 1) status++;
        else status--;

        if (status == 0) {
            choices = "\r\n兔兔币余额：#r" + cm.getHyPay(1) + "#k兔兔币 (#r买后不支持退货哟亲#k)";
            for (var i = 0; i < itemxh.length; i++) {
                choices += "\r\n#L" + i + "##v" + itemxh[i] + "##z" + itemxh[i] + "#　#d需要#r" + itemxhcost[i] + "#d兔兔币#k#l";
            }
            cm.sendSimpleS("欢迎来到时尚美食店,你想买我们商店的物品么?请选择吧：." + choices,2);
        } else if (status == 1) {
                cm.sendGetNumber("你选择的商品为#v" + itemxh[selection] + "#售价为：" + itemxhcost[selection] + "兔兔币/个\r\n请输入你购买的数量",1,1,cm.getHyPay(1));
		choice = selection;
        } else if (status == 2) {
            fee = selection;
            money = fee*itemxhcost[choice];
            if (fee < 0) {
            cm.sendOk("你输入的数负数!");
            cm.dispose();
            } else if (cm.getHyPay(1) < money) {
            cm.sendOk("兑换失败，你没有" + money + "个兔兔币");
            cm.dispose();
            } else {
	    cm.addHyPay(money);
            cm.gainItem(itemxh[choice], fee); //圣杯
            cm.sendOk("恭喜，购买成功。");
            cm.dispose();
                }
        }
    }
}